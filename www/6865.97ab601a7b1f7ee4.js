"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6865],{6865:(M,m,c)=>{c.r(m),c.d(m,{LetsRequestPageModule:()=>Z});var _=c(6895),v=c(433),r=c(8058),f=c(1407),L=c(655),u=c(4573),p=c(529),t=c(8274),q=c(5085),b=c(2553),x=c(7832);function y(s,a){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&s){const e=t.oxw().$implicit;t.xp6(1),t.hij(", ",e.age,"")}}function C(s,a){if(1&s){const e=t.EpF();t.TgZ(0,"ion-button",17),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,n=t.oxw(2);return t.KtG(n.reportLets(i))}),t._uU(1,"Report"),t.qZA()}}function R(s,a){1&s&&(t.TgZ(0,"ion-button",18),t._uU(1,"Reported"),t.qZA())}function P(s,a){if(1&s){const e=t.EpF();t.TgZ(0,"div",6),t._UZ(1,"img",7),t.TgZ(2,"div",8)(3,"div",9),t._uU(4),t.YNc(5,y,2,1,"span",10),t.qZA(),t.TgZ(6,"div",11),t._uU(7),t.qZA(),t.TgZ(8,"div",12),t._uU(9),t.qZA(),t.TgZ(10,"ion-button",13),t.NdJ("click",function(){const n=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.acceptLetsRequest(n))}),t._uU(11,"Accept"),t.qZA(),t.TgZ(12,"ion-button",14),t.NdJ("click",function(){const n=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.ignoreLetsRequest(n))}),t._uU(13,"Ignore"),t.qZA(),t.YNc(14,C,2,0,"ion-button",15),t.YNc(15,R,2,0,"ion-button",16),t.qZA()()}if(2&s){const e=a.$implicit;t.xp6(1),t.s9C("src",e.profile_pic,t.LSH),t.xp6(3),t.Oqu(e.name),t.xp6(1),t.Q6J("ngIf",""!=e.age),t.xp6(2),t.hij("Intrested in : ",e.lets_text,""),t.xp6(2),t.Oqu(e.vaccination),t.xp6(5),t.Q6J("ngIf",0==e.report_flag),t.xp6(1),t.Q6J("ngIf",0!=e.report_flag)}}function w(s,a){if(1&s&&(t.TgZ(0,"div",4),t.YNc(1,P,16,7,"div",5),t.qZA()),2&s){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.requestList)}}function A(s,a){1&s&&(t.TgZ(0,"div",4)(1,"div",19),t._uU(2,"No requesting lets available. Try later.."),t.qZA()())}const O=[{path:"",component:(()=>{class s{constructor(e,o,i,n,l,h,d,g,T){this.navCtrl=e,this.http=o,this.toastCtrl=i,this.alertCtrl=n,this.socket=l,this.geolocation=h,this.platform=d,this.loadingCtrl=g,this.diagnostic=T,this.requestList=Array()}ngOnInit(){this.getLetsRequest()}getLetsRequest(){const e={client_key:u.L.client_key,user_id:localStorage.getItem("il_user_id")};this.http.post(u.L.baseURL+"/services/getLetsRequest",e,{headers:(new p.WM).set("content-type","application/x-www-form-urlencoded")}).subscribe(o=>{this.resultObj=o,200==this.resultObj.code&&(this.requestList=this.resultObj.data)},o=>{this.toastCtrl.create({message:"Please check your network connectivity and try logging in again..",position:"top",duration:2700,cssClass:"custom-failure-class"}).then(i=>{i.present()})})}acceptLetsRequest(e){return(0,L.mG)(this,void 0,void 0,function*(){this.diagnostic.isLocationEnabled().then(i=>{i||this.toastCtrl.create({message:"Enable location to create lets.",position:"top",duration:2700,cssClass:"custom-failure-class"}).then(n=>{n.present()})}).catch(i=>{console.log(i)}),this.diagnostic.isLocationAuthorized().then(i=>{this.diagnostic.requestLocationAuthorization(this.diagnostic.locationAuthorizationMode.ALWAYS).then(n=>{n!=this.diagnostic.permissionStatus.NOT_REQUESTED&&n!=this.diagnostic.permissionStatus.DENIED&&n!=this.diagnostic.permissionStatus.DENIED_ALWAYS||this.toastCtrl.create({message:"Allow App location permission to create lets.",position:"top",duration:2700,cssClass:"custom-failure-class"}).then(l=>{l.present()})})}).catch(i=>{console.log(i)}),console.log("Step3");const o=this.loadingCtrl.create({message:"Please wait..."});o.then(i=>{i.present()}),yield this.platform.ready(),this.geolocation.getCurrentPosition().then(i=>{this.currentLat=i.coords.latitude,this.currentLang=i.coords.longitude;var n=parseInt(e.lets_id);const l={client_key:u.L.client_key,user_id:localStorage.getItem("il_user_id"),lets_id:n,current_lat:this.currentLat,current_lng:this.currentLang};this.http.post(u.L.baseURL+"/services/acceptLetsRequest",l,{headers:(new p.WM).set("content-type","application/x-www-form-urlencoded")}).subscribe(h=>{if(o.then(g=>{g.dismiss()}),this.resultObj=h,200==this.resultObj.code){this.toastCtrl.create({message:"All the best!!!",position:"top",duration:2700,cssClass:"custom-success-class"}).then(g=>{g.present()});var d=this.resultObj.lets_user_socket_id;this.socket.emit("newaccepted",{lets_id:n,accepted_user_id:localStorage.getItem("il_user_id"),socket_id:d}),this.navCtrl.navigateForward("/accepted-waiting/"+n)}else this.toastCtrl.create({message:this.resultObj.message,position:"top",duration:2700,cssClass:"custom-failure-class"}).then(g=>{g.present()}),this.navCtrl.navigateForward("/lets-request")},h=>{o.then(d=>{d.dismiss()}),this.toastCtrl.create({message:"Please check your network connectivity and try logging in again..",position:"top",duration:2700,cssClass:"custom-failure-class"}).then(d=>{d.present()})})}).catch(i=>{this.retryAcceptLetsRequest(e),console.log("Error getting location",i)})})}retryAcceptLetsRequest(e){return(0,L.mG)(this,void 0,void 0,function*(){yield(yield this.alertCtrl.create({header:"Location",subHeader:"Did not find your location. Click accept to retry.",buttons:[{text:"Accept",role:"cancel",handler:()=>{this.acceptLetsRequest(e)}}]})).present()})}ignoreLetsRequest(e){const o={client_key:u.L.client_key,lets_id:e.lets_id,user_id:localStorage.getItem("il_user_id")};this.http.post(u.L.baseURL+"/services/ignoreLetsRequest",o,{headers:(new p.WM).set("content-type","application/x-www-form-urlencoded")}).subscribe(i=>{this.resultObj=i,200==this.resultObj.code&&this.requestList.splice(this.requestList.indexOf(e),1)},i=>{this.toastCtrl.create({message:"Please check your network connectivity and try logging in again..",position:"top",duration:2700,cssClass:"custom-failure-class"}).then(n=>{n.present()})})}reportLets(e){const o={client_key:u.L.client_key,report_user_id:e.user_id,lets_id:e.lets_id,user_id:localStorage.getItem("il_user_id")};this.http.post(u.L.baseURL+"/services/reportLets",o,{headers:(new p.WM).set("content-type","application/x-www-form-urlencoded")}).subscribe(i=>{this.resultObj=i,200==this.resultObj.code&&(e.report_flag=1,this.toastCtrl.create({message:this.resultObj.message,position:"top",duration:2700,cssClass:"custom-success-class"}).then(n=>{n.present()}))},i=>{this.toastCtrl.create({message:"Please check your network connectivity and try logging in again..",position:"top",duration:2700,cssClass:"custom-failure-class"}).then(n=>{n.present()})})}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(r.SH),t.Y36(p.eN),t.Y36(r.yF),t.Y36(r.Br),t.Y36(q.s),t.Y36(b.b),t.Y36(r.t4),t.Y36(r.HT),t.Y36(x.R))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-lets-request"]],decls:9,vars:2,consts:[[1,"transparent-navbar","white-text"],["slot","start"],[1,"dark-bg","white-text","ion-padding"],["class","full-content lets-content",4,"ngIf"],[1,"full-content","lets-content"],["class","request-container",4,"ngFor","ngForOf"],[1,"request-container"],["alt","Default Pic",1,"request-img",3,"src"],[1,"request-detail-holder"],[1,"request-name"],[4,"ngIf"],[1,"request-lets"],[1,"request-vaccination"],["shape","round","color","secondary",1,"action-btn",3,"click"],["shape","round","color","danger",1,"action-btn",3,"click"],["shape","round","color","light","class","action-btn",3,"click",4,"ngIf"],["fill","clear","color","danger",4,"ngIf"],["shape","round","color","light",1,"action-btn",3,"click"],["fill","clear","color","danger"],[1,"empty-msg","text-center","white-text"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t._UZ(3,"ion-back-button"),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5,"Requesting Lets"),t.qZA()()(),t.TgZ(6,"ion-content",2),t.YNc(7,w,2,1,"div",3),t.YNc(8,A,3,0,"div",3),t.qZA()),2&e&&(t.xp6(7),t.Q6J("ngIf",o.requestList.length>0),t.xp6(1),t.Q6J("ngIf",o.requestList.length<=0))},dependencies:[_.sg,_.O5,r.oU,r.YG,r.Sm,r.W2,r.Gu,r.wd,r.sr,r.cs],styles:[".transparent-navbar[_ngcontent-%COMP%]{background-color:#065efe}.lets-content[_ngcontent-%COMP%]{padding-top:45px}.request-container[_ngcontent-%COMP%]{display:inline-block;width:100%;border:solid 1px #dedede;background-color:#fff;border-radius:15px;overflow:hidden}.request-img[_ngcontent-%COMP%]{width:100%;height:70vh}.request-detail-holder[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:0 10px 15px}.request-name[_ngcontent-%COMP%]{color:#333;font-size:20px;font-weight:800;margin-top:5px;margin-bottom:5px;text-align:left}.request-age[_ngcontent-%COMP%]{color:#333;font-weight:500;text-align:left}.request-lets[_ngcontent-%COMP%], .request-vaccination[_ngcontent-%COMP%], .request-locality[_ngcontent-%COMP%]{color:#333;font-size:16px;margin-bottom:5px}.action-btn.button-round-md[_ngcontent-%COMP%]{border-radius:64px;padding:0 2rem;text-transform:none}"]}),s})()}];let k=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[f.Bz.forChild(O),f.Bz]}),s})(),Z=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[_.ez,v.u5,r.Pc,k]}),s})()}}]);